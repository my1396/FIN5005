<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Menghan Yuan" />


<title>Causal Effects</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Course Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Causal Effects</h1>
<h4 class="author">Menghan Yuan</h4>
<h4 class="date">Oct 23, 2024</h4>

</div>


<SCRIPT language="JavaScript" SRC="my_jxscript.js"></SCRIPT>
<p><a class="top-link" href="#top" id="js-top">↑</a></p>
<div id="introduction-case" class="section level2">
<h2>Introduction Case</h2>
<p>The Heart and Estrogen/Progestin Study (HERS) is a clinical trial of hormone therapy for prevention of recurrent heart attacks and death among post-menopausal women with existing coronary heart disease.</p>
<p>In this exercise we will study how different variables may influence the glucose level in the blood for the non-diabetic women in the cohort, in particular we are interested to see if exercise may help to reduce the glucose level.</p>
<p>To answer this question definitively would require a randomized clinical trial, a difficult and expensive undertaking. As a result, research questions like this are often initially looked at using observational data. But this is complicated by the fact that people who exercise differ in many ways from those who do not, and some of the other differences might explain any unadjusted association between exercise and glucose level.</p>
<pre class="r"><code># load data
hers &lt;- read.table(&quot;https://raw.githubusercontent.com/my1396/course_dataset/refs/heads/main/hers.txt&quot;,
                   sep=&quot;\t&quot;, header=T, na.strings=&quot;.&quot;)
hers %&gt;% head(20)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["HT"],"name":[1],"type":["int"],"align":["right"]},{"label":["age"],"name":[2],"type":["int"],"align":["right"]},{"label":["raceth"],"name":[3],"type":["int"],"align":["right"]},{"label":["nonwhite"],"name":[4],"type":["int"],"align":["right"]},{"label":["smoking"],"name":[5],"type":["int"],"align":["right"]},{"label":["drinkany"],"name":[6],"type":["int"],"align":["right"]},{"label":["exercise"],"name":[7],"type":["int"],"align":["right"]},{"label":["physact"],"name":[8],"type":["int"],"align":["right"]},{"label":["globrat"],"name":[9],"type":["int"],"align":["right"]},{"label":["poorfair"],"name":[10],"type":["int"],"align":["right"]},{"label":["medcond"],"name":[11],"type":["int"],"align":["right"]},{"label":["htnmeds"],"name":[12],"type":["int"],"align":["right"]},{"label":["statins"],"name":[13],"type":["int"],"align":["right"]},{"label":["diabetes"],"name":[14],"type":["int"],"align":["right"]},{"label":["dmpills"],"name":[15],"type":["int"],"align":["right"]},{"label":["insulin"],"name":[16],"type":["int"],"align":["right"]},{"label":["weight"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["BMI"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["waist"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["WHR"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["glucose"],"name":[21],"type":["int"],"align":["right"]},{"label":["weight1"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["BMI1"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["waist1"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["WHR1"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["glucose1"],"name":[26],"type":["int"],"align":["right"]},{"label":["tchol"],"name":[27],"type":["int"],"align":["right"]},{"label":["LDL"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["HDL"],"name":[29],"type":["int"],"align":["right"]},{"label":["TG"],"name":[30],"type":["int"],"align":["right"]},{"label":["tchol1"],"name":[31],"type":["int"],"align":["right"]},{"label":["LDL1"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["HDL1"],"name":[33],"type":["int"],"align":["right"]},{"label":["TG1"],"name":[34],"type":["int"],"align":["right"]},{"label":["SBP"],"name":[35],"type":["int"],"align":["right"]},{"label":["DBP"],"name":[36],"type":["int"],"align":["right"]},{"label":["id"],"name":[37],"type":["int"],"align":["right"]},{"label":["afr_amer"],"name":[38],"type":["int"],"align":["right"]},{"label":["othereth"],"name":[39],"type":["int"],"align":["right"]},{"label":["age10"],"name":[40],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"70","3":"2","4":"1","5":"0","6":"0","7":"0","8":"5","9":"3","10":"0","11":"0","12":"1","13":"1","14":"0","15":"0","16":"0","17":"73.8","18":"23.69","19":"96.0","20":"0.932","21":"84","22":"73.6","23":"23.63","24":"93.0","25":"0.912","26":"94","27":"189","28":"122.4","29":"52","30":"73","31":"201","32":"137.6","33":"48","34":"77","35":"138","36":"78","37":"1","38":"1","39":"0","40":"7.0","_rn_":"1"},{"1":"0","2":"62","3":"2","4":"1","5":"0","6":"0","7":"0","8":"1","9":"3","10":"0","11":"1","12":"1","13":"0","14":"0","15":"0","16":"0","17":"70.9","18":"28.62","19":"93.0","20":"0.964","21":"111","22":"73.4","23":"28.89","24":"95.0","25":"0.964","26":"78","27":"307","28":"241.6","29":"44","30":"107","31":"216","32":"150.6","33":"48","34":"87","35":"118","36":"70","37":"2","38":"1","39":"0","40":"6.2","_rn_":"2"},{"1":"1","2":"69","3":"1","4":"0","5":"0","6":"0","7":"0","8":"3","9":"3","10":"0","11":"0","12":"1","13":"0","14":"1","15":"0","16":"0","17":"102.0","18":"42.51","19":"110.2","20":"0.782","21":"114","22":"96.1","23":"40.73","24":"103.0","25":"0.774","26":"98","27":"254","28":"166.2","29":"57","30":"154","31":"254","32":"156.0","33":"66","34":"160","35":"134","36":"78","37":"3","38":"0","39":"0","40":"6.9","_rn_":"3"},{"1":"0","2":"64","3":"1","4":"0","5":"1","6":"1","7":"0","8":"1","9":"3","10":"0","11":"1","12":"1","13":"0","14":"0","15":"0","16":"0","17":"64.4","18":"24.39","19":"87.0","20":"0.877","21":"94","22":"58.6","23":"22.52","24":"77.0","25":"0.802","26":"93","27":"204","28":"116.2","29":"56","30":"159","31":"207","32":"122.6","33":"57","34":"137","35":"152","36":"72","37":"4","38":"0","39":"0","40":"6.4","_rn_":"4"},{"1":"0","2":"65","3":"1","4":"0","5":"0","6":"0","7":"0","8":"2","9":"3","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"57.9","18":"21.90","19":"77.0","20":"0.794","21":"101","22":"58.9","23":"22.28","24":"76.5","25":"0.757","26":"92","27":"214","28":"150.6","29":"42","30":"107","31":"235","32":"172.2","33":"35","34":"139","35":"175","36":"95","37":"5","38":"0","39":"0","40":"6.5","_rn_":"5"},{"1":"1","2":"68","3":"2","4":"1","5":"0","6":"1","7":"0","8":"3","9":"3","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"60.9","18":"29.05","19":"96.0","20":"1.000","21":"116","22":"57.7","23":"27.52","24":"86.0","25":"0.910","26":"115","27":"212","28":"137.8","29":"52","30":"111","31":"202","32":"126.6","33":"53","34":"112","35":"174","36":"98","37":"6","38":"1","39":"0","40":"6.8","_rn_":"6"},{"1":"0","2":"70","3":"1","4":"0","5":"0","6":"0","7":"0","8":"3","9":"2","10":"1","11":"0","12":"0","13":"0","14":"1","15":"0","16":"1","17":"89.3","18":"34.45","19":"114.5","20":"0.974","21":"120","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"314","28":"228.8","29":"33","30":"261","31":"NA","32":"NA","33":"NA","34":"NA","35":"119","36":"61","37":"7","38":"0","39":"0","40":"7.0","_rn_":"7"},{"1":"1","2":"69","3":"1","4":"0","5":"0","6":"0","7":"1","8":"5","9":"4","10":"0","11":"0","12":"1","13":"1","14":"0","15":"0","16":"0","17":"52.1","18":"23.16","19":"70.2","20":"0.798","21":"95","22":"55.2","23":"23.99","24":"72.0","25":"0.774","26":"95","27":"195","28":"121.2","29":"46","30":"139","31":"190","32":"113.4","33":"54","34":"113","35":"178","36":"82","37":"8","38":"0","39":"0","40":"6.9","_rn_":"8"},{"1":"1","2":"61","3":"1","4":"0","5":"0","6":"1","7":"1","8":"3","9":"4","10":"0","11":"1","12":"1","13":"0","14":"0","15":"0","16":"0","17":"76.7","18":"30.26","19":"89.0","20":"0.824","21":"105","22":"78.6","23":"31.45","24":"92.0","25":"0.829","26":"113","27":"213","28":"133.0","29":"50","30":"150","31":"211","32":"106.2","33":"57","34":"239","35":"162","36":"70","37":"9","38":"0","39":"0","40":"6.1","_rn_":"9"},{"1":"1","2":"62","3":"1","4":"0","5":"1","6":"1","7":"0","8":"2","9":"3","10":"0","11":"0","12":"1","13":"0","14":"0","15":"0","16":"0","17":"112.0","18":"45.68","19":"139.7","20":"0.933","21":"98","22":"98.4","23":"40.64","24":"131.5","25":"0.943","26":"98","27":"303","28":"220.0","29":"40","30":"215","31":"240","32":"173.2","33":"39","34":"139","35":"111","36":"71","37":"10","38":"0","39":"0","40":"6.2","_rn_":"10"},{"1":"0","2":"72","3":"2","4":"1","5":"0","6":"0","7":"0","8":"3","9":"2","10":"1","11":"0","12":"1","13":"0","14":"0","15":"0","16":"0","17":"62.3","18":"22.18","19":"78.5","20":"0.773","21":"111","22":"63.9","23":"23.08","24":"79.0","25":"0.782","26":"96","27":"278","28":"172.8","29":"82","30":"116","31":"273","32":"192.0","33":"57","34":"120","35":"122","36":"84","37":"11","38":"1","39":"0","40":"7.2","_rn_":"11"},{"1":"1","2":"73","3":"1","4":"0","5":"0","6":"0","7":"0","8":"4","9":"3","10":"0","11":"1","12":"1","13":"0","14":"0","15":"0","16":"0","17":"73.2","18":"25.27","19":"93.0","20":"0.886","21":"95","22":"73.2","23":"25.27","24":"95.0","25":"0.900","26":"107","27":"201","28":"123.8","29":"47","30":"151","31":"224","32":"149.4","33":"51","34":"118","35":"158","36":"84","37":"12","38":"0","39":"0","40":"7.3","_rn_":"12"},{"1":"0","2":"52","3":"1","4":"0","5":"1","6":"0","7":"0","8":"4","9":"3","10":"0","11":"1","12":"1","13":"1","14":"0","15":"0","16":"0","17":"54.7","18":"24.15","19":"78.0","20":"0.867","21":"97","22":"53.3","23":"24.17","24":"80.5","25":"0.861","26":"90","27":"228","28":"150.8","29":"63","30":"71","31":"237","32":"161.2","33":"55","34":"104","35":"120","36":"78","37":"13","38":"0","39":"0","40":"5.2","_rn_":"13"},{"1":"1","2":"57","3":"1","4":"0","5":"1","6":"0","7":"0","8":"2","9":"2","10":"1","11":"0","12":"1","13":"0","14":"0","15":"0","16":"0","17":"68.6","18":"28.12","19":"95.0","20":"0.941","21":"109","22":"63.4","23":"25.99","24":"88.0","25":"0.898","26":"100","27":"259","28":"153.4","29":"49","30":"283","31":"198","32":"97.0","33":"52","34":"245","35":"182","36":"95","37":"14","38":"0","39":"0","40":"5.7","_rn_":"14"},{"1":"0","2":"57","3":"1","4":"0","5":"0","6":"0","7":"1","8":"5","9":"5","10":"0","11":"0","12":"0","13":"0","14":"1","15":"0","16":"0","17":"101.0","18":"37.41","19":"116.0","20":"0.960","21":"138","22":"104.0","23":"39.01","24":"117.5","25":"0.951","26":"147","27":"269","28":"207.0","29":"40","30":"110","31":"298","32":"221.2","33":"46","34":"154","35":"181","36":"97","37":"15","38":"0","39":"0","40":"5.7","_rn_":"15"},{"1":"0","2":"65","3":"1","4":"0","5":"1","6":"0","7":"1","8":"5","9":"2","10":"1","11":"1","12":"1","13":"0","14":"0","15":"0","16":"0","17":"49.9","18":"20.45","19":"74.0","20":"0.841","21":"94","22":"48.9","23":"20.70","24":"75.0","25":"0.847","26":"82","27":"163","28":"92.4","29":"49","30":"108","31":"155","32":"84.0","33":"43","34":"140","35":"150","36":"84","37":"16","38":"0","39":"0","40":"6.5","_rn_":"16"},{"1":"1","2":"62","3":"1","4":"0","5":"1","6":"0","7":"0","8":"5","9":"2","10":"1","11":"0","12":"1","13":"0","14":"1","15":"1","16":"0","17":"82.9","18":"34.55","19":"102.0","20":"0.887","21":"133","22":"79.0","23":"33.48","24":"111.0","25":"0.949","26":"144","27":"164","28":"103.4","29":"29","30":"158","31":"158","32":"94.2","33":"31","34":"164","35":"139","36":"80","37":"17","38":"0","39":"0","40":"6.2","_rn_":"17"},{"1":"1","2":"64","3":"1","4":"0","5":"0","6":"0","7":"0","8":"5","9":"5","10":"0","11":"0","12":"1","13":"1","14":"0","15":"0","16":"0","17":"63.1","18":"22.30","19":"80.0","20":"0.777","21":"92","22":"60.9","23":"21.99","24":"81.0","25":"0.764","26":"90","27":"223","28":"123.2","29":"80","30":"99","31":"249","32":"154.4","33":"63","34":"158","35":"148","36":"78","37":"18","38":"0","39":"0","40":"6.4","_rn_":"18"},{"1":"0","2":"50","3":"1","4":"0","5":"0","6":"0","7":"1","8":"3","9":"3","10":"0","11":"0","12":"1","13":"0","14":"0","15":"0","16":"0","17":"67.4","18":"23.63","19":"83.0","20":"0.810","21":"99","22":"64.8","23":"22.88","24":"80.0","25":"0.808","26":"98","27":"227","28":"154.6","29":"40","30":"162","31":"224","32":"150.6","33":"41","34":"162","35":"101","36":"74","37":"19","38":"0","39":"0","40":"5.0","_rn_":"19"},{"1":"0","2":"58","3":"1","4":"0","5":"1","6":"1","7":"0","8":"5","9":"5","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"62.0","18":"20.48","19":"77.0","20":"0.778","21":"117","22":"55.9","23":"18.74","24":"69.5","25":"0.747","26":"128","27":"253","28":"165.2","29":"62","30":"129","31":"225","32":"143.6","33":"54","34":"137","35":"141","36":"83","37":"20","38":"0","39":"0","40":"5.8","_rn_":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Women with diabetes are excluded because the research question is whether exercise might help to prevent progression to diabetes among women at risk, and because the causal determinants of glucose may be different in that group.</p>
<pre class="r"><code># create a subset of interest
hers.no &lt;- hers[hers$diabetes==0, ]</code></pre>
<div id="descriptive-analysis" class="section level3">
<h3>Descriptive Analysis</h3>
<p>We will start out by investigating how the glucose levels are for women who exercise at least three times a week (coded as exercise=1) and women who exercise less than three times a week (coded as exercise=0).</p>
<p><span class="math display">\[
\text{exercise} = \begin{cases}
1 &amp; \text{exercise three times or more} \\
0 &amp; \text{otherwise}.
\end{cases}
\]</span></p>
<p>Make a summary and boxplot of the glucose levels according to the level of exercise:</p>
<pre class="r"><code>summary(hers.no$glucose[hers.no$exercise==0])</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   67.00   90.00   96.00   97.36  103.00  125.00</code></pre>
<pre class="r"><code>summary(hers.no$glucose[hers.no$exercise==1])</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   47.00   89.00   95.00   95.67  101.00  125.00</code></pre>
<pre class="r"><code>boxplot(hers.no$glucose~hers.no$exercise)</code></pre>
<p><img src="09_Oct_21_Causal-Effects_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Test if there is a difference in glucose level and make a confidence interval:</p>
<pre class="r"><code>t.test(glucose~exercise, var.equal=T, data=hers.no)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  glucose by exercise
## t = 3.8685, df = 2030, p-value = 0.000113
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  0.8346242 2.5509539
## sample estimates:
## mean in group 0 mean in group 1 
##        97.36104        95.66825</code></pre>
<p>Perform a simple linear regression with glucose level as outcome and exercise as predictor:</p>
<pre class="r"><code>fit.simple &lt;- lm(glucose~exercise,data=hers.no)
summary(fit.simple)</code></pre>
<pre><code>## 
## Call:
## lm(formula = glucose ~ exercise, data = hers.no)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -48.668  -6.668  -0.668   5.639  29.332 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  97.3610     0.2815 345.848  &lt; 2e-16 ***
## exercise     -1.6928     0.4376  -3.868 0.000113 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.715 on 2030 degrees of freedom
## Multiple R-squared:  0.007318,   Adjusted R-squared:  0.006829 
## F-statistic: 14.97 on 1 and 2030 DF,  p-value: 0.000113</code></pre>
<p>The coefficient estimate for <code>exercise</code> shows that average baseline glucose levels were about 1.7 mg/dL lower among women who exercised at least three times a week than among women who exercised less. This difference is statistically significant (<span class="math inline">\(t=-3:87\)</span>; <span class="math inline">\(P &lt; 1\%\)</span>).</p>
<p><strong>Why the simple regression might be problematic?</strong></p>
<p>The women who exercise at least three times a week and the women who exercise less than three times a week may differ in many ways.
For example they may be younger and have a lower BMI (body mass index).
This implies that the lower average glucose we observe among women who exercise could be due at least in part to differences in these other predictors.
In other words, <code>age</code> and <code>BMI</code> can be potential confounders that confound the effect of exercise on glucose levels.</p>
<p><strong>What is a fix for the confounding effect?</strong></p>
<p>Intuitively, under these conditions, it is important that our estimate of the difference in average glucose levels associated with exercise be “adjusted” for the effects of these potential confounders of the unadjusted association.</p>
<p>Technically, adjustment using a <em>multipredictor</em> regression model provides an estimate of the causal effect of exercise on average glucose levels, by <em>holding the other variables constant</em>.</p>
<p>We will therefore perform a multiple linear regression analysis where we adjust for <code>age</code> and <code>BMI</code>. These two variable are commonly referred to as “control variables” or “conditional variables”.</p>
<p>Perform a multivariate regression with glucose level as outcome and exercise, age, and BMI as predictors:</p>
<table style="text-align:center">
<caption>
<strong>Regression results for the effect of exercises on the glucose level.</strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
glucose
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
exercise
</td>
<td>
-1.693<sup>***</sup>
</td>
<td>
-0.905<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.438)
</td>
<td>
(0.430)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
age
</td>
<td>
</td>
<td>
0.057<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.031)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
BMI
</td>
<td>
</td>
<td>
0.485<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.042)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
97.361<sup>***</sup>
</td>
<td>
79.854<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.282)
</td>
<td>
(2.563)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
2,032
</td>
<td>
2,030
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.007
</td>
<td>
0.070
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.007
</td>
<td>
0.068
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
9.715 (df = 2030)
</td>
<td>
9.413 (df = 2026)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
14.965<sup>***</sup> (df = 1; 2030)
</td>
<td>
50.570<sup>***</sup> (df = 3; 2026)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<span>***</span>: p&lt;0.01; <span>**</span>: <strong>p&lt;0.05</strong>; <span>*</span>: p&lt;0.1 <br> Standard errors in the parentheses.
</td>
</tr>
</table>
<p>We see that in the multiple regression where we control for age and BMI</p>
<ul>
<li><p>Exercise remains a statistically significant predictor of glucose levels after adjustment for age and BMI.</p></li>
<li><p>Average glucose is estimated to be only about 0.9 mg/dL lower among women who exercise, holding the other three factors constant.</p></li>
<li><p>Average levels also increase by about 0.5 mg/dL per unit increase in BMI, and by 0.06 mg/dL for each additional year of age.</p></li>
</ul>
<p>In summary, the simple linear regression estimates the difference in mean glucose levels between two subgroups (<code>exercise</code> being 1 or 0). But this comparison ignores other ways in which those subgroups may differ. In other words, the analysis does not take account of confounding of the association we see.</p>
<p>In contrast, the adjusted coefficient for exercise in the multivariate regression takes account of the fact that women who exercise also have lower BMI and are slightly younger, all factors which are associated with differences in glucose levels.</p>
<p>Confounders often explain some of the association of a predictor of interest with the outcome, so that the <strong>adjusted effect</strong>, which may have a causal interpretation, is often <span style="color:#337ab7">weaker</span> than the <strong>unadjusted effect</strong>.</p>
<p>However, this is not always true. There are a range of Confounding Patterns.
Here we will show two patterns using simulated data in what follows.</p>
<hr />
</div>
</div>
<div id="counfounding-pattern-1" class="section level2">
<h2>Counfounding Pattern 1</h2>
<p>To fix ideas, we</p>
<ul>
<li>Let <span class="math inline">\(D\)</span> be a treatment indicator that takes values 0 (control group) or 1 (treatment group).</li>
<li>Define <span class="math inline">\(X\)</span> be a potential confounder.</li>
<li>Define <span class="math inline">\(y\)</span> be the outcome variable.</li>
</ul>
<p>At one extreme, the effect of a factor of interest may be completely confounded by a second variable.</p>
<p>In plain language,</p>
<ul>
<li><span class="math inline">\(D\)</span> and <span class="math inline">\(y\)</span> are strongly associated in unadjusted analysis,</li>
<li>after adjusted for <span class="math inline">\(X\)</span>, the variation in <span class="math inline">\(y\)</span> can be entirely explained by <span class="math inline">\(X\)</span>. That is, there is no association between <span class="math inline">\(y\)</span> and <span class="math inline">\(D\)</span> after adjustment for <span class="math inline">\(X\)</span>.</li>
</ul>
<p><span class="math display">\[
D \overset{?}{\rightarrow} X \rightarrow Y
\]</span>
We simulate data based on the following DGP.</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x + \varepsilon.
\]</span>
where <span class="math inline">\(\beta_0=0.2\)</span> and <span class="math inline">\(\beta_1=1\)</span>.</p>
<p>Data set up.</p>
<pre class="r"><code>D &lt;- rep(c(0, 1), each = 4)
X &lt;- seq(from=1, by=1, length=length(D))
beta0 &lt;- 0.2
beta1 &lt;- 1
epsilon &lt;- rnorm(n=length(D), sd=0.01)
y &lt;- beta0 + beta1*X + epsilon
data &lt;- tibble(&quot;D&quot;=factor(D), X, y)
data</code></pre>
<pre><code>## # A tibble: 8 × 3
##   D         X     y
##   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 0         1  1.20
## 2 0         2  2.22
## 3 0         3  3.20
## 4 0         4  4.20
## 5 1         5  5.20
## 6 1         6  6.20
## 7 1         7  7.21
## 8 1         8  8.19</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:confound-suspicious"></span>
<img src="images/confounding_suspicious_simulation.png" alt="Suspicious correlation due to confounding." width="100%" />
<p class="caption">
Fig. 1: Suspicious correlation due to confounding.
</p>
</div>
<p>Run the following three regressions.</p>
<pre class="r"><code>confound1_unadjusted &lt;- lm(y~D, data=data)
confound1_adjusted1 &lt;- lm(y~D+X, data=data)
confound1_adjusted2 &lt;- lm(y~X, data=data)</code></pre>
<table style="text-align:center">
<caption>
<strong>Regression Results for Simulated Confounding — Suspicious Correlation</strong>
</caption>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
y
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
Unadjusted
</td>
<td>
Conditional on X
</td>
<td>
True model
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
D1
</td>
<td>
3.995<sup>***</sup>
</td>
<td>
-0.003
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.912)
</td>
<td>
(0.012)
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
X
</td>
<td>
</td>
<td>
1.000<sup>***</sup>
</td>
<td>
0.999<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.003)
</td>
<td>
(0.001)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
2.704<sup>***</sup>
</td>
<td>
0.206<sup>***</sup>
</td>
<td>
0.207<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.645)
</td>
<td>
(0.008)
</td>
<td>
(0.006)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
8
</td>
<td>
8
</td>
<td>
8
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.762
</td>
<td>
1.000
</td>
<td>
1.000
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.722
</td>
<td>
1.000
</td>
<td>
1.000
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.290 (df = 6)
</td>
<td>
0.008 (df = 5)
</td>
<td>
0.007 (df = 6)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
19.169<sup>***</sup> (df = 1; 6)
</td>
<td>
325,352.300<sup>***</sup> (df = 2; 5)
</td>
<td>
769,487.000<sup>***</sup> (df = 1; 6)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="3" style="text-align:right">
<span>***</span>: p&lt;0.01; <span>**</span>: <strong>p&lt;0.05</strong>; <span>*</span>: p&lt;0.1 <br> Standard errors in the parentheses.
</td>
</tr>
</table>
<hr />
</div>
<div id="counfounding-pattern-2" class="section level2">
<h2>Counfounding Pattern 2</h2>
<p>At the other extreme, we may find little or no association in unadjusted analysis, because it is <em>masked or negatively confounded by another predictor</em>.</p>
<ul>
<li>In the unadjusted analysis, there seems to be no association between <span class="math inline">\(y\)</span> and <span class="math inline">\(D\)</span>.</li>
<li>But when adjusted for <span class="math inline">\(X\)</span>, there are significant differences for the groups defined by <span class="math inline">\(D\)</span>.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:confound-negative-DAG"></span>
<img src="images/DAG_negative_confounding.png" alt="Directional Acyclic Graph (DAG): Negative confounding." width="30%" />
<p class="caption">
Fig. 2: Directional Acyclic Graph (DAG): Negative confounding.
</p>
</div>
<p>We simulate data based on the following DGP.</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x + \beta_2 D + \varepsilon ,
\]</span>
where <span class="math inline">\(\beta_0=0.2\)</span>, <span class="math inline">\(\beta_1=1\)</span> and <span class="math inline">\(\beta_2=-4\)</span>.</p>
<p>Data set up.</p>
<pre class="r"><code>D &lt;- rep(c(0, 1), each = 4)
X &lt;- seq(from=1, by=1, length=length(D))
beta0 &lt;- 0.2
beta1 &lt;- 1
beta2 &lt;- -4
epsilon &lt;- rnorm(n=length(D), sd=0.01)
y &lt;- beta0 + beta1*X + beta2*D + epsilon
data &lt;- tibble(&quot;D&quot;=factor(D), X, y)
data</code></pre>
<pre><code>## # A tibble: 8 × 3
##   D         X     y
##   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 0         1  1.19
## 2 0         2  2.19
## 3 0         3  3.21
## 4 0         4  4.20
## 5 1         5  1.19
## 6 1         6  2.20
## 7 1         7  3.20
## 8 1         8  4.20</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:confound-negative-sim"></span>
<img src="images/confounding_negative_simulation.png" alt="Negative confounding." width="100%" />
<p class="caption">
Fig. 3: Negative confounding.
</p>
</div>
<p>Run the following two regressions.</p>
<pre class="r"><code>confound2_unadjusted &lt;- lm(y~D, data=data)
confound2_adjusted &lt;- lm(y~D+X, data=data)</code></pre>
<table style="text-align:center">
<caption>
<strong>Regression Results for Simulated Negative Confounding</strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
y
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
Unadjusted
</td>
<td>
Conditional on X
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
D1
</td>
<td>
0.00004
</td>
<td>
-4.012<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.916)
</td>
<td>
(0.009)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
X
</td>
<td>
</td>
<td>
1.003<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.002)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
2.698<sup>***</sup>
</td>
<td>
0.191<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.647)
</td>
<td>
(0.006)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
8
</td>
<td>
8
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.000
</td>
<td>
1.000
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
-0.167
</td>
<td>
1.000
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.295 (df = 6)
</td>
<td>
0.007 (df = 5)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
0.000 (df = 1; 6)
</td>
<td>
117,054.500<sup>***</sup> (df = 2; 5)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<span>***</span>: p&lt;0.01; <span>**</span>: <strong>p&lt;0.05</strong>; <span>*</span>: p&lt;0.1 <br> Standard errors in the parentheses.
</td>
</tr>
</table>
<p>In summary, the association between <span class="math inline">\(D\)</span> and <span class="math inline">\(y\)</span> is unmasked by adjustment for <span class="math inline">\(X\)</span>. Negative confounding can occur under the following circumstances:</p>
<ul>
<li>The predictors are inversely correlated, but have regression coefficients with the same sign.</li>
<li>The two predictors are positively correlated, but have regression coefficients with the opposite sign.</li>
</ul>
<p>The example shown in Fig. <a href="#fig:confound-negative-sim">3</a> is of the second kind.</p>
<p><strong>Confounding Is Difficult to Rule Out</strong></p>
<p>The problem of confounding can be more resistant to multivariate regression modeling than the example might suggest. We assumed in that example that the model included all confounders of the effect of exercises on glucose levels.
Nonetheless, for the multivariate linear model to control confounding successfully and estimate causal effects without bias, all potential confounders must have been:</p>
<ul>
<li>Recognized and assessed by design in the study</li>
<li>Measured without error</li>
<li>Accurately represented in the structural model</li>
</ul>
<p>Logically, of course, it is not possible to show that all confounders have been measured, and in some cases it may be clear that they have not. Furthermore, the hypothetical causal framework may be uncertain, especially in the early stages of an investigating a research question.</p>
<p>Also, measurement error in predictors is common; this may arise in some cases because the study has only measured proxies for the causal variables which actually confound a predictor of interest.</p>
<p>In practice, <strong>many confounders can be unobservable</strong>. A classical question in labor economics is whether college education increases earnings. We have unobserved background factors, such as genetic, family environment, and mental ability. These factors are unobservable but play a significant role in influencing wage levels.</p>
<p>Finally, DGP in the structural model cannot be taken for granted.</p>
<p><strong>Mathematical formulation when we have unobserved confounders</strong></p>
<p>We can write a full model for the response variable <span class="math inline">\(y\)</span> as
<span class="math display">\[
y=h(x_1, \boldsymbol{x}_2, \boldsymbol{u})
\]</span>
where <span class="math inline">\(x_1\)</span> and <span class="math inline">\(\boldsymbol{x}_2\)</span> are the observed variables, <span class="math inline">\(\boldsymbol{u}\)</span> is an unobserved factor, and <span class="math inline">\(h\)</span> is a functional relationship.</p>
<p>We define the causal effect of <span class="math inline">\(x_1\)</span> (the variable of primary interest) within this model as the change in <span class="math inline">\(y\)</span> due to a change in <span class="math inline">\(x_1\)</span> holding the other variables <span class="math inline">\(\boldsymbol{x}_2\)</span> and <span class="math inline">\(\boldsymbol{u}\)</span> constant.</p>
<p><span class="math inline">\(x_1\)</span> is often binary and takes values either <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>. In this case, the causal effect of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y\)</span> is given by</p>
<p><span class="math display">\[
C(x_1, \boldsymbol{x}_2, \boldsymbol{u}) = h(1, \boldsymbol{x}_2, \boldsymbol{u}) - h(0, \boldsymbol{x}_2, \boldsymbol{u}) .
\]</span></p>
<p>In practice, it is rarely possible that we observe both outcomes when <span class="math inline">\(x_1=1\)</span> (given treatment) and when <span class="math inline">\(x_1=0\)</span> (non-treatment). We only observe the realized value either <span class="math inline">\(h(1, \boldsymbol{x}_2, \boldsymbol{u})\)</span> or <span class="math inline">\(h(0, \boldsymbol{x}_2, \boldsymbol{u})\)</span>.</p>
<div class="boxed">
<p style="font-weight:bold;">
Conditional Independence Assumption (CIA)
</p>
<p>If conditional on <span class="math inline">\(\boldsymbol{x}_2\)</span>, the random variables <span class="math inline">\(x_1\)</span> and <span class="math inline">\(\boldsymbol{u}\)</span> are statistically independent, then the regression coefficient of <span class="math inline">\(x_1\)</span> equals the average causal effect for <span class="math inline">\(x_1\)</span> on <span class="math inline">\(y\)</span> conditional on <span class="math inline">\(\boldsymbol{x}_2\)</span>.</p>
</div>
<p>In plain language, it says that whenever the unobservable is independent of the treatment variable (after conditioning on appropriate regressors) the regression derivative equals the average causal effect.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
